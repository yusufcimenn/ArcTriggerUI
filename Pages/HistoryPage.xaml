<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ArcTriggerUI.Pages.HistoryPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="History"
    BackgroundColor="{AppThemeBinding Light=#F9FAFB, Dark=#0C0C0F}">

    <Grid Padding="12" RowDefinitions="Auto,*">

        <!-- Üstte Refresh butonu -->
        <HorizontalStackLayout Grid.Row="0" HorizontalOptions="End" Spacing="8" Margin="0,0,0,6">
            <Button Text="Refresh" Clicked="OnReloadClicked" />
        </HorizontalStackLayout>

        <!-- Kart Liste -->
        <RefreshView x:Name="RefreshHost"
                     Grid.Row="1"
                     IsRefreshing="{Binding IsBusy}"
                     Command="{Binding RefreshCommand}">

            <CollectionView ItemsSource="{Binding Orders}"
                            SelectionMode="Single"
                            SelectionChanged="OnOrderSelected"
                            ItemsLayout="VerticalList">

                <!-- EmptyView -->
                <CollectionView.EmptyView>
                    <VerticalStackLayout Padding="24" Spacing="6" HorizontalOptions="Center" VerticalOptions="Center">
                        <Label Text="No orders found" Opacity="0.7"/>
                        <Button Text="Reload" Clicked="OnReloadClicked"/>
                    </VerticalStackLayout>
                </CollectionView.EmptyView>

                <!-- Kart Template -->
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame  
                               
                               BorderColor="{AppThemeBinding Light=#E5E7EB, Dark=#2D2F34}"
                               BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1B1D22}"
                               CornerRadius="12"
                               HasShadow="True">
                            <VerticalStackLayout Spacing="6" >

                                <!-- Üst Bilgiler -->
                                <HorizontalStackLayout>
                                    <Label Text="{Binding Ticker}" 
                                           FontAttributes="Bold" 
                                           FontSize="16"/>
                                    <Label Text="{Binding CompanyName}" 
                                           FontSize="14"
                                           TextColor="{AppThemeBinding Light=#6B7280, Dark=#9CA3AF}"
                                           Margin="6,0,0,0"
                                           LineBreakMode="TailTruncation"/>
                                </HorizontalStackLayout>

                                <!-- Detay Bilgiler -->
                                <Grid ColumnDefinitions="*,*,*">
                                    <Label Text="{Binding Side}" Grid.Column="0"
                                           TextColor="{AppThemeBinding Light=#2563EB, Dark=#60A5FA}"
                                           FontAttributes="Bold"/>
                                    <Label Text="{Binding Status}" Grid.Column="1"
                                           TextColor="{AppThemeBinding Light=#10B981, Dark=#34D399}"/>
                                    <Label Text="{Binding QuantityText}" Grid.Column="2"
                                           HorizontalOptions="End"/>
                                </Grid>

                                <!-- Fiyat Bilgisi -->
                                <Label Text="{Binding PriceText}" 
                                       FontSize="14" 
                                       FontAttributes="Bold" 
                                       HorizontalOptions="End"/>
                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </RefreshView>
    </Grid>
</ContentPage>
